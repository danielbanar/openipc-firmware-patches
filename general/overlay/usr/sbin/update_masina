#!/bin/sh
WG_CONFIG_CUSTOM="/root/wireguard"

# Load configuration as shell variables
if [ -e "$WG_CONFIG_CUSTOM" ]; then
    . "$WG_CONFIG_CUSTOM"
else
    echo "Error: Config file $WG_CONFIG_CUSTOM not found." >&2
    exit 1
fi

# Verify IP is set
if [ -z "$IP" ]; then
    echo "Error: IP variable not set in configuration." >&2
    exit 1
fi

# Run yaml-cli command
yaml-cli -s .outgoing.server "udp://$IP:2222"
if [ $? -eq 0 ]; then
    echo "yaml-cli command executed successfully."
    exit 0
else
    echo "Error: Failed to execute yaml-cli command." >&2
    exit 1
fi